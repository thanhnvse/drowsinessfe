{"remainingRequest":"D:\\capstone\\HostelFrontEnd-BV2\\node_modules\\thread-loader\\dist\\cjs.js!D:\\capstone\\HostelFrontEnd-BV2\\node_modules\\babel-loader\\lib\\index.js!D:\\capstone\\HostelFrontEnd-BV2\\node_modules\\@vue\\cli-plugin-eslint\\node_modules\\eslint-loader\\index.js??ref--13-0!D:\\capstone\\HostelFrontEnd-BV2\\src\\utils\\utils.js","dependencies":[{"path":"D:\\capstone\\HostelFrontEnd-BV2\\src\\utils\\utils.js","mtime":1610216666530},{"path":"D:\\capstone\\HostelFrontEnd-BV2\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\capstone\\HostelFrontEnd-BV2\\node_modules\\thread-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\capstone\\HostelFrontEnd-BV2\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\capstone\\HostelFrontEnd-BV2\\node_modules\\@vue\\cli-plugin-eslint\\node_modules\\eslint-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJyZWdlbmVyYXRvci1ydW50aW1lL3J1bnRpbWUiOwppbXBvcnQgX2FzeW5jVG9HZW5lcmF0b3IgZnJvbSAiRDovY2Fwc3RvbmUvSG9zdGVsRnJvbnRFbmQtQlYyL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9hc3luY1RvR2VuZXJhdG9yIjsKaW1wb3J0IGp3dCBmcm9tICdqc29ud2VidG9rZW4nOwppbXBvcnQgZmlyZWJhc2UgZnJvbSAnLi4vY29uZmlnL2ZpcmViYXNlJzsKdmFyIGF1dGggPSBmaXJlYmFzZS5hdXRoOwoKZnVuY3Rpb24gaXNGaXJlYmFzZUxvZ2dlZEluKCkgewogIC8vIHJldHVybiBhdXRoLmN1cnJlbnRVc2VyOwogIHJldHVybiB3aW5kb3cuJGNvb2tpZXMuZ2V0KCdmaXJlYmFzZUxvZ2dlZEluJyk7Cn0KCmZ1bmN0aW9uIGNoZWNrSWZUb2tlbk5lZWRzUmVmcmVzaCgpIHsKICByZXR1cm4gX2NoZWNrSWZUb2tlbk5lZWRzUmVmcmVzaC5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwp9CgpmdW5jdGlvbiBfY2hlY2tJZlRva2VuTmVlZHNSZWZyZXNoKCkgewogIF9jaGVja0lmVG9rZW5OZWVkc1JlZnJlc2ggPSBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUoKSB7CiAgICB2YXIgZmlyZWJhc2VJZFRva2VuLCBkZWNvZGVkLCBleHA7CiAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZSQoX2NvbnRleHQpIHsKICAgICAgd2hpbGUgKDEpIHsKICAgICAgICBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7CiAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgIGlmIChpc0ZpcmViYXNlTG9nZ2VkSW4oKSkgewogICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAyOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CgogICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuYWJydXB0KCJyZXR1cm4iLCBmYWxzZSk7CgogICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICBmaXJlYmFzZUlkVG9rZW4gPSB3aW5kb3cuJGNvb2tpZXMuZ2V0KCdmaXJlYmFzZUlkVG9rZW4nKTsKCiAgICAgICAgICAgIGlmICghZmlyZWJhc2VJZFRva2VuKSB7CiAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDE2OwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CgogICAgICAgICAgICBfY29udGV4dC5wcmV2ID0gNDsKICAgICAgICAgICAgZGVjb2RlZCA9IGp3dC5kZWNvZGUoZmlyZWJhc2VJZFRva2VuKTsKICAgICAgICAgICAgZXhwID0gZGVjb2RlZC5leHA7CgogICAgICAgICAgICBpZiAoIShleHAgJiYgZXhwIDwgKG5ldyBEYXRlKCkuZ2V0VGltZSgpICsgMSkgLyAxMDAwKSkgewogICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAxMDsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgY29uc29sZS5sb2coJ2ZpcmViYXNlIGlkIHRva2VuIG5lZWRzIHRvIHJlZnJlc2gnKTsKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LmFicnVwdCgicmV0dXJuIiwgdHJ1ZSk7CgogICAgICAgICAgY2FzZSAxMDoKICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDE2OwogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlIDEyOgogICAgICAgICAgICBfY29udGV4dC5wcmV2ID0gMTI7CiAgICAgICAgICAgIF9jb250ZXh0LnQwID0gX2NvbnRleHRbImNhdGNoIl0oNCk7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKF9jb250ZXh0LnQwKTsKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LmFicnVwdCgicmV0dXJuIiwgZmFsc2UpOwoKICAgICAgICAgIGNhc2UgMTY6CiAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5hYnJ1cHQoInJldHVybiIsIGZhbHNlKTsKCiAgICAgICAgICBjYXNlIDE3OgogICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LnN0b3AoKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0sIF9jYWxsZWUsIG51bGwsIFtbNCwgMTJdXSk7CiAgfSkpOwogIHJldHVybiBfY2hlY2tJZlRva2VuTmVlZHNSZWZyZXNoLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7Cn0KCmZ1bmN0aW9uIHVwZGF0ZVRva2VuKCkgewogIHJldHVybiBfdXBkYXRlVG9rZW4uYXBwbHkodGhpcywgYXJndW1lbnRzKTsKfQoKZnVuY3Rpb24gX3VwZGF0ZVRva2VuKCkgewogIF91cGRhdGVUb2tlbiA9IF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTIoKSB7CiAgICB2YXIgbmV3RmlyZWJhc2VJZFRva2VuOwogICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUyJChfY29udGV4dDIpIHsKICAgICAgd2hpbGUgKDEpIHsKICAgICAgICBzd2l0Y2ggKF9jb250ZXh0Mi5wcmV2ID0gX2NvbnRleHQyLm5leHQpIHsKICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgaWYgKCFhdXRoLmN1cnJlbnRVc2VyKSB7CiAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSA3OwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CgogICAgICAgICAgICBjb25zb2xlLmxvZygndXBkYXRlIGZpcmViYXNlIGlkIHRva2VuJyk7CiAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gNDsKICAgICAgICAgICAgcmV0dXJuIGF1dGguY3VycmVudFVzZXIuZ2V0SWRUb2tlbih0cnVlKTsKCiAgICAgICAgICBjYXNlIDQ6CiAgICAgICAgICAgIG5ld0ZpcmViYXNlSWRUb2tlbiA9IF9jb250ZXh0Mi5zZW50OwogICAgICAgICAgICBkb2N1bWVudC5jb29raWUgPSAiZmlyZWJhc2VJZFRva2VuPSIuY29uY2F0KG5ld0ZpcmViYXNlSWRUb2tlbik7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKG5ld0ZpcmViYXNlSWRUb2tlbik7CgogICAgICAgICAgY2FzZSA3OgogICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5zdG9wKCk7CiAgICAgICAgfQogICAgICB9CiAgICB9LCBfY2FsbGVlMik7CiAgfSkpOwogIHJldHVybiBfdXBkYXRlVG9rZW4uYXBwbHkodGhpcywgYXJndW1lbnRzKTsKfQoKdmFyIGZ1bmN0aW9ucyA9IHsKICBpc0ZpcmViYXNlTG9nZ2VkSW46IGlzRmlyZWJhc2VMb2dnZWRJbiwKICBjaGVja0lmVG9rZW5OZWVkc1JlZnJlc2g6IGNoZWNrSWZUb2tlbk5lZWRzUmVmcmVzaCwKICB1cGRhdGVUb2tlbjogdXBkYXRlVG9rZW4KfTsKZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb25zOw=="},{"version":3,"sources":["D:/capstone/HostelFrontEnd-BV2/src/utils/utils.js"],"names":["jwt","firebase","auth","isFirebaseLoggedIn","window","$cookies","get","checkIfTokenNeedsRefresh","firebaseIdToken","decoded","decode","exp","Date","getTime","console","log","updateToken","currentUser","getIdToken","newFirebaseIdToken","document","cookie","functions"],"mappings":";;AAAA,OAAOA,GAAP,MAAgB,cAAhB;AACA,OAAOC,QAAP,MAAqB,oBAArB;IAEQC,I,GAASD,Q,CAATC,I;;AAER,SAASC,kBAAT,GAA8B;AAC5B;AACA,SAAOC,MAAM,CAACC,QAAP,CAAgBC,GAAhB,CAAoB,kBAApB,CAAP;AACD;;SAEcC,wB;;;;;sFAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBACOJ,kBAAkB,EADzB;AAAA;AAAA;AAAA;;AAAA,6CAEW,KAFX;;AAAA;AAIQK,YAAAA,eAJR,GAI0BJ,MAAM,CAACC,QAAP,CAAgBC,GAAhB,CAAoB,iBAApB,CAJ1B;;AAAA,iBAKME,eALN;AAAA;AAAA;AAAA;;AAAA;AAOYC,YAAAA,OAPZ,GAOsBT,GAAG,CAACU,MAAJ,CAAWF,eAAX,CAPtB;AAQcG,YAAAA,GARd,GAQsBF,OARtB,CAQcE,GARd;;AAAA,kBASUA,GAAG,IAAIA,GAAG,GAAG,CAAC,IAAIC,IAAJ,GAAWC,OAAX,KAAuB,CAAxB,IAA6B,IATpD;AAAA;AAAA;AAAA;;AAUQC,YAAAA,OAAO,CAACC,GAAR,CAAY,oCAAZ;AAVR,6CAWe,IAXf;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAcMD,YAAAA,OAAO,CAACC,GAAR;AAdN,6CAea,KAfb;;AAAA;AAAA,6CAkBS,KAlBT;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,G;;;;SAqBeC,W;;;;;yEAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iBACMd,IAAI,CAACe,WADX;AAAA;AAAA;AAAA;;AAEIH,YAAAA,OAAO,CAACC,GAAR,CAAY,0BAAZ;AAFJ;AAAA,mBAGqCb,IAAI,CAACe,WAAL,CAAiBC,UAAjB,CAA4B,IAA5B,CAHrC;;AAAA;AAGUC,YAAAA,kBAHV;AAIIC,YAAAA,QAAQ,CAACC,MAAT,6BAAqCF,kBAArC;AACAL,YAAAA,OAAO,CAACC,GAAR,CAAYI,kBAAZ;;AALJ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,G;;;;AASA,IAAMG,SAAS,GAAG;AAChBnB,EAAAA,kBAAkB,EAAlBA,kBADgB;AAEhBI,EAAAA,wBAAwB,EAAxBA,wBAFgB;AAGhBS,EAAAA,WAAW,EAAXA;AAHgB,CAAlB;AAMA,eAAeM,SAAf","sourcesContent":["import jwt from 'jsonwebtoken';\nimport firebase from '../config/firebase';\n\nconst { auth } = firebase;\n\nfunction isFirebaseLoggedIn() {\n  // return auth.currentUser;\n  return window.$cookies.get('firebaseLoggedIn');\n}\n\nasync function checkIfTokenNeedsRefresh() {\n  if (!isFirebaseLoggedIn()) {\n    return false;\n  }\n  const firebaseIdToken = window.$cookies.get('firebaseIdToken');\n  if (firebaseIdToken) {\n    try {\n      const decoded = jwt.decode(firebaseIdToken);\n      const { exp } = decoded;\n      if (exp && exp < (new Date().getTime() + 1) / 1000) {\n        console.log('firebase id token needs to refresh');\n        return true;\n      }\n    } catch (error) {\n      console.log(error);\n      return false;\n    }\n  }\n  return false;\n}\n\nasync function updateToken() {\n  if (auth.currentUser) {\n    console.log('update firebase id token');\n    const newFirebaseIdToken = await auth.currentUser.getIdToken(true);\n    document.cookie = `firebaseIdToken=${newFirebaseIdToken}`;\n    console.log(newFirebaseIdToken);\n  }\n}\n\nconst functions = {\n  isFirebaseLoggedIn,\n  checkIfTokenNeedsRefresh,\n  updateToken,\n};\n\nexport default functions;\n"]}]}